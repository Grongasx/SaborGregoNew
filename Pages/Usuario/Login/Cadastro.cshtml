@page
@model SaborGregoNew.Pages.Usuario.CadastroModel

@{
    ViewData["Title"] = "Cadastro";
}

<div class="min-vh-100 d-flex align-items-center justify-content-center py-5" style="background: linear-gradient(135deg, rgba(255, 107, 53, 0.05) 0%, rgba(247, 147, 30, 0.05) 100%);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-5">
                <!-- Card com fundo transparente/escuro para modo dark -->
                <div class="card shadow-lg border-0 rounded-4" style="background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px);">
                    <div class="card-body p-5">
                        <!-- Logo/Header -->
                        <div class="text-center mb-4">
                            <div class="mb-3">
                                <i class="bi bi-person-plus-fill" style="font-size: 3rem; color: #ff6b35;"></i>
                            </div>
                            <h2 class="fw-bold mb-2 text-white" style="color: #ff6b35;">Criar Conta</h2>
                            <!-- Substituído text-muted por text-white-50 -->
                            <p class="text-white-50">Junte-se ao Sabor Grego</p>
                        </div>

                        <!-- Mensagens de Validação -->
                        <div asp-validation-summary="All" class="alert alert-danger d-none" role="alert"></div>

                        <!-- Formulário -->
                        <form method="post" id="registerForm">
                            <!-- Nome -->
                            <div class="mb-3">
                                <!-- Labels com text-white -->
                                <label for="nome" class="form-label fw-semibold text-white">
                                    <i class="bi bi-person me-1"></i>Nome Completo
                                </label>
                                <input 
                                    asp-for="Usuario!.Nome" 
                                    id="nome" 
                                    class="form-control form-control-lg" 
                                    placeholder="Digite seu nome completo"
                                    required
                                />
                                <span asp-validation-for="Usuario!.Nome" class="text-danger small"></span>
                            </div>

                            <!-- Telefone -->
                            <div class="mb-3">
                                <label for="telefone" class="form-label fw-semibold text-white">
                                    <i class="bi bi-telephone me-1"></i>Telefone
                                </label>
                                <input 
                                    asp-for="Usuario!.Telefone" 
                                    id="telefone" 
                                    class="form-control form-control-lg" 
                                    placeholder="(11) 99999-9999"
                                    required
                                />
                                <span asp-validation-for="Usuario!.Telefone" class="text-danger small"></span>
                            </div>

                            <!-- E-mail -->
                            <div class="mb-3">
                                <label for="email" class="form-label fw-semibold text-white">
                                    <i class="bi bi-envelope me-1"></i>E-mail
                                </label>
                                <input 
                                    asp-for="Usuario!.Email" 
                                    id="email" 
                                    type="email"
                                    class="form-control form-control-lg" 
                                    placeholder="seu@email.com"
                                    required
                                />
                                <span asp-validation-for="Usuario!.Email" class="text-danger small"></span>
                            </div>

                            <!-- Senha -->
                            <div class="mb-3">
                                <label for="senha" class="form-label fw-semibold text-white">
                                    <i class="bi bi-lock me-1"></i>Senha
                                </label>
                                <div class="input-group">
                                    <input 
                                        asp-for="Usuario!.Senha" 
                                        id="senha" 
                                        type="password"
                                        class="form-control form-control-lg" 
                                        placeholder="Mínimo 6 caracteres"
                                        required
                                        minlength="6"
                                    />
                                    <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                        <i class="bi bi-eye" id="toggleIcon"></i>
                                    </button>
                                </div>
                                <span asp-validation-for="Usuario!.Senha" class="text-danger small"></span>
                                <!-- form-text com text-white-50 -->
                                <div class="form-text text-white-50">
                                    <small>A senha deve ter no mínimo 6 caracteres</small>
                                </div>
                            </div>

                            <!-- Confirmar Senha -->
                            <div class="mb-4">
                                <label for="confirmarSenha" class="form-label fw-semibold text-white">
                                    <i class="bi bi-lock-fill me-1"></i>Confirmar Senha
                                </label>
                                <input 
                                    type="password"
                                    id="confirmarSenha" 
                                    class="form-control form-control-lg" 
                                    placeholder="Digite a senha novamente"
                                    required
                                />
                                <span id="senhaError" class="text-danger small d-none">As senhas não coincidem</span>
                            </div>

                            <!-- Termos -->
                            <div class="mb-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="termos" required>
                                    <!-- Label com text-white-50 -->
                                    <label class="form-check-label small text-white-50" for="termos">
                                        Concordo com os <a href="/Home/Privacy" class="text-decoration-none" style="color: #ff6b35;">Termos de Uso</a> 
                                        e <a href="/Home/Privacy" class="text-decoration-none" style="color: #ff6b35;">Política de Privacidade</a>
                                    </label>
                                </div>
                            </div>

                            <!-- Botão Cadastrar -->
                            <button 
                                type="submit" 
                                class="btn btn-lg w-100 text-white fw-semibold mb-3"
                                style="background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%); border: none;"
                            >
                                <i class="bi bi-person-check me-2"></i>Cadastrar
                            </button>

                            <!-- Link para Login -->
                            <div class="text-center">
                                <!-- Texto com text-white-50 -->
                                <p class="text-white-50 mb-0">
                                    Já tem uma conta? 
                                    <a href="/Usuario/Login" class="text-decoration-none fw-semibold" style="color: #ff6b35;">
                                        Fazer Login
                                    </a>
                                </p>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Máscara de telefone
        document.getElementById('telefone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/^(\d{2})(\d)/g, '($1) $2');
                value = value.replace(/(\d)(\d{4})$/, '$1-$2');
                e.target.value = value;
            }
        });

        // Toggle mostrar/ocultar senha
        document.getElementById('togglePassword').addEventListener('click', function() {
            const senhaInput = document.getElementById('senha');
            const toggleIcon = document.getElementById('toggleIcon');
            
            if (senhaInput.type === 'password') {
                senhaInput.type = 'text';
                toggleIcon.classList.remove('bi-eye');
                toggleIcon.classList.add('bi-eye-slash');
            } else {
                senhaInput.type = 'password';
                toggleIcon.classList.remove('bi-eye-slash');
                toggleIcon.classList.add('bi-eye');
            }
        });

        // Validação de confirmação de senha
        const form = document.getElementById('registerForm');
        const senha = document.getElementById('senha');
        const confirmarSenha = document.getElementById('confirmarSenha');
        const senhaError = document.getElementById('senhaError');

        confirmarSenha.addEventListener('input', function() {
            if (senha.value !== confirmarSenha.value) {
                senhaError.classList.remove('d-none');
                confirmarSenha.classList.add('is-invalid');
            } else {
                senhaError.classList.add('d-none');
                confirmarSenha.classList.remove('is-invalid');
                confirmarSenha.classList.add('is-valid');
            }
        });

        // Validação no submit
        form.addEventListener('submit', function(e) {
            if (senha.value !== confirmarSenha.value) {
                e.preventDefault();
                senhaError.classList.remove('d-none');
                confirmarSenha.focus();
                return false;
            }

            // Feedback visual
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Cadastrando...';
            submitBtn.disabled = true;
        });

        // Validação em tempo real dos campos
        const inputs = form.querySelectorAll('input[required]');
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (this.value.trim() === '') {
                    this.classList.add('is-invalid');
                } else {
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                }
            });
        });

        // Validação de email
        document.getElementById('email').addEventListener('blur', function() {
            const emailRegex = /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/;
            if (!emailRegex.test(this.value)) {
                this.classList.add('is-invalid');
            } else {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            }
        });
    </script>
}
